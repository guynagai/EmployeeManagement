<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>シフト割り当て</title>
    <style>
        .task-container {
            display: block;
            margin-bottom: 15px;
        }
        .task-group {
            margin-bottom: 10px;
        }
        .task-group label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }
        .task-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 5px;
        }
        .task-item input[type="checkbox"] {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <h1>シフト割り当て</h1>
    <div th:if="${error != null}">
        <p style="color: red;" th:text="${error}"></p>
    </div>
    <form th:action="@{/admin/shifts/assign}" method="post">
        <label for="workDate">作業日:</label>
        <input type="date" id="workDate" name="workDate" th:value="${workDate}"/>
        <div th:each="workplace, iterStat : ${workplaces}">
            <h2 th:text="${workplace.name}"></h2>
            <input type="hidden" th:name="'assignments[' + ${iterStat.index} + '][workplaceId]'" th:value="${workplace.id}"/>
            <div th:unless="${workplace.name == '選果場'}">
                <h3>タスク（複数選択可）:</h3>
                <div class="task-container">
                    <div class="task-group">
                        <label>主要作業:</label>
                        <div class="task-item" th:each="task : ${firstHouseTasks}">
                            <input type="checkbox" th:name="'assignments[' + ${iterStat.index} + '][tasks][]'" th:value="${task.id}"/>
                            <label th:text="${task.name}"></label>
                        </div>
                    </div>
                    <div class="task-group">
                        <label>その他作業:</label>
                        <div class="task-item" th:each="task : ${secondHouseTasks}">
                            <input type="checkbox" th:name="'assignments[' + ${iterStat.index} + '][tasks][]'" th:value="${task.id}"/>
                            <label th:text="${task.name}"></label>
                        </div>
                    </div>
                </div>
            </div>
            <div th:if="${workplace.name == '選果場'}">
                <p>タスク: 選果（固定）</p>
            </div>
            <div>
                <h3>人数:</h3>
                <label>AM:</label>
                <input type="number" th:name="'assignments[' + ${iterStat.index} + '][am][count]'" min="0" value="0"/>
                <label>PM:</label>
                <input type="number" th:name="'assignments[' + ${iterStat.index} + '][pm][count]'" min="0" value="0"/>
            </div>
        </div>
        <button type="submit">割り当て</button>
    </form>
</body>
</html>