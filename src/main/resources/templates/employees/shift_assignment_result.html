<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>シフト割り当て結果</title>
</head>
<body>
    <h1>シフト割り当て結果</h1>
    <h2>作業日: <span th:text="${workDate.format(T(java.time.format.DateTimeFormatter).ofPattern('yyyy-MM-dd'))}"></span></h2>

    <h3>割り当て</h3>
    <table border="1">
        <tr>
            <th>職場</th>
            <th>タスク</th>
            <th>AM 人数</th>
            <th>PM 人数</th>
        </tr>
        <th:block th:each="entry : ${assignments}">
            <tr>
                <td th:text="${workplaces[entry.key]}"></td>
                <td th:text="${entry.value.get('tasks') != null} ? ${T(java.lang.String).join(', ', entry.value.get('tasks'))} : 'なし'"></td>
                <td th:text="${entry.value.get('am_count') ?: 0}"></td>
                <td th:text="${entry.value.get('pm_count') ?: 0}"></td>
            </tr>
        </th:block>
        <th:block th:if="${#maps.isEmpty(assignments)}">
            <tr>
                <td colspan="4">割り当てなし</td>
            </tr>
        </th:block>
    </table>

    <h3>出勤予定社員</h3>
    <table border="1">
        <tr>
            <th>社員ID</th>
            <th>名前</th>
            <th>スキルレベル</th>
            <th>時間帯</th>
        </tr>
        <th:block th:each="employee : ${availableEmployees}">
            <tr>
                <td th:text="${employee.key}"></td>
                <td th:text="${employee.value.get('name')}"></td>
                <td th:text="${employee.value.get('skillLevel')}"></td>
                <td th:text="${T(java.lang.String).join(', ', employee.value.get('timeSlots'))}"></td>
            </tr>
        </th:block>
        <th:block th:if="${#maps.isEmpty(availableEmployees)}">
            <tr>
                <td colspan="4">出勤予定社員なし</td>
            </tr>
        </th:block>
    </table>

    <h3>人数集計</h3>
    <ul>
        <li>リーダー: <span th:text="${employeeCounts.get('leader')}"></span></li>
        <li>一般: <span th:text="${employeeCounts.get('general')}"></span></li>
        <li>新人: <span th:text="${employeeCounts.get('newcomer')}"></span></li>
        <li>AM 合計: <span th:text="${employeeCounts.get('amTotal')}"></span></li>
        <li>PM 合計: <span th:text="${employeeCounts.get('pmTotal')}"></span></li>
    </ul>

    <a href="/admin/shifts/assign">戻る</a>
</body>
</html>