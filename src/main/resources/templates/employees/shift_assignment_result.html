<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>シフト割り当て結果</title>
    <style>
        .error {
            color: red;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .section {
            margin-bottom: 15px;
        }
        .employee-list {
            margin-left: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>シフト割り当て結果</h1>
    <div th:if="${error}" class="error" th:text="${error}"></div>
    <div>
        <h2>作業日: <span th:text="${workDate.format(T(java.time.format.DateTimeFormatter).ofPattern('yyyy-MM-dd'))}"></span></h2>
    </div>

    <div class="section" th:each="entry : ${assignments}">
        <h3 th:text="${entry.value.workplaceName}"></h3>
        <table>
            <tr>
                <th>項目</th>
                <th>詳細</th>
            </tr>
            <tr>
                <td>タスク</td>
                <td>
                    <span th:if="${entry.value.tasks != null and not #lists.isEmpty(entry.value.tasks)}"
                          th:text="${T(java.lang.String).join(', ', entry.value.tasks)}"></span>
                    <span th:if="${entry.value.tasks == null or #lists.isEmpty(entry.value.tasks)}">なし</span>
                </td>
            </tr>
            <tr>
                <td>AM 人数</td>
                <td th:text="${entry.value.amCount}"></td>
            </tr>
            <tr>
                <td>PM 人数</td>
                <td th:text="${entry.value.pmCount}"></td>
            </tr>
            <tr>
                <td>割り当て社員</td>
                <td>
                    <div class="employee-list" th:if="${entry.value.assignedEmployees != null and not #lists.isEmpty(entry.value.assignedEmployees)}">
                        <div th:each="employee : ${entry.value.assignedEmployees}">
                            <span th:text="${employee.name} + ' (' + ${employee.skillLevel} + ', ' + ${employee.timeSlot} + ')'"></span>
                        </div>
                    </div>
                    <div th:if="${entry.value.assignedEmployees == null or #lists.isEmpty(entry.value.assignedEmployees)}">
                        なし
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <a href="/admin/shifts/assign">戻る</a>
</body>
</html>